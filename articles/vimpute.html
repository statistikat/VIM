<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Imputation Method vimpute • VIM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Imputation Method vimpute">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VIM</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">7.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/VIM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/donorImp.html">Donor based Imputation Methods</a>
    </li>
    <li>
      <a href="../articles/impPCA.html">Imputation Method based on Iterative EM PCA</a>
    </li>
    <li>
      <a href="../articles/irmi.html">Imputation Method IRMI</a>
    </li>
    <li>
      <a href="../articles/modelImp.html">Model based Imputation Methods</a>
    </li>
    <li>
      <a href="../articles/vimpute.html">Imputation Method vimpute</a>
    </li>
    <li>
      <a href="../articles/VisualImp.html">Supportive Graphic Methods</a>
    </li>
    <li>
      <a href="../articles/xgboostImpute.html">Imputation Method based on xgboost</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statistikat/VIM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="vimpute_files/core-js-2.5.3/shim.min.js"></script><script src="vimpute_files/react-18.2.0/react.min.js"></script><script src="vimpute_files/react-18.2.0/react-dom.min.js"></script><script src="vimpute_files/reactwidget-2.0.0/react-tools.js"></script><link href="vimpute_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="vimpute_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="vimpute_files/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="vimpute_files/reactable-binding-0.4.4/reactable.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Imputation Method vimpute</h1>
                        <h4 data-toc-skip class="author">Eileen
Vattheuer</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/statistikat/VIM/blob/master/vignettes/vimpute.Rmd" class="external-link"><code>vignettes/vimpute.Rmd</code></a></small>
      <div class="hidden name"><code>vimpute.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use the <code><a href="../reference/vimpute.html">vimpute()</a></code>
function for flexible missing data imputation using machine learning
models from the mlr3 ecosystem.</p>
<div class="section level3">
<h3 id="function-arguments">Function Arguments<a class="anchor" aria-label="anchor" href="#function-arguments"></a>
</h3>
<ul>
<li>
<code>data</code>: A datatable or dataframe containing missing
values to be imputed.</li>
<li>
<code>considered_variables</code>: A character vector of variable
names to be either imputed or used as predictors, excluding irrelevant
columns from the imputation process.</li>
<li>
<code>method</code>: A named list specifying the imputation method
for each variable.</li>
<li>
<code>pmm</code>: TRUE/FALSE indicating whether predictive mean
matching is used. Provide as a list for each variable.</li>
<li>
<code>formula</code>: If not all variables are used as predictors,
or if transformations or interactions are required (applies to all X,
for Y only transformations are possible). Only applicable for the
methods “robust” andc “regularized”. Provide as a list for each variable
that requires specific conditions.</li>
<li>
<code>sequential</code>: Specifies whether the imputation should be
performed sequentially.</li>
<li>
<code>nseq</code>: The number of sequential iterations, if
<code>sequential</code>is TRUE.</li>
<li>
<code>eps</code>: The convergence threshold for sequential
imputation.</li>
<li>
<code>imp_var</code>: Specifies whether to add indicator variables
for imputed values.</li>
<li>
<code>pred_history</code>: If enabled, saves the prediction
history.</li>
<li>
<code>tune</code>: Whether to perform hyperparameter tuning.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>To demonstrate the function, the <code>sleep</code> dataset from the
<code>VIM</code> package is used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="fu">VIM</span><span class="fu">::</span><span class="va"><a href="../reference/sleep.html">sleep</a></span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggr.html">aggr</a></span><span class="op">(</span><span class="va">sleep</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a</span>, numbers <span class="op">=</span> <span class="cn">TRUE</span>, prop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vimpute_files/figure-html/setup_2-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The left plot shows the amount of missings for each column in the
dataset sleep and the right plot shows how often each combination of
missings occur. For example, there are 9 rows wich contain a missing in
both NonD and Dream.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataDS</span> <span class="op">&lt;-</span> <span class="va">sleep</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dream"</span>, <span class="st">"Sleep"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/marginplot.html">marginplot</a></span><span class="op">(</span><span class="va">dataDS</span>, main <span class="op">=</span> <span class="st">"Missing Values"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vimpute_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The <strong><font color="red">red</font></strong> boxplot on the left
shows the distrubution of all values of Sleep where Dream contains a
missing value. The <strong><font color="#87ceeb">blue</font></strong>
boxplot on the left shows the distribution of the values of Sleep where
Dream is observed.</p>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="section level3">
<h3 id="default-imputation">Default Imputation<a class="anchor" aria-label="anchor" href="#default-imputation"></a>
</h3>
<p>In the basic usage, the <code><a href="../reference/vimpute.html">vimpute()</a></code> function performs
imputation using the default settings. It uses the “ranger” method for
all variables, applies predictive mean matching, and performs sequential
imputation with a convergence threshold of 0.005.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vimpute.html">vimpute</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  pred_history <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">data</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     BodyWgt BrainWgt  NonD Dream Sleep  Span  Gest  Pred   Exp Danger NonD_imp</span></span>
<span><span class="co">#&gt;       &lt;num&gt;    &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;  &lt;num&gt;   &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt; 1: 6654.000   5712.0   3.3   1.3   3.3  38.6   645     3     5      3     TRUE</span></span>
<span><span class="co">#&gt; 2:    1.000      6.6   6.3   2.0   8.3   4.5    42     3     1      3    FALSE</span></span>
<span><span class="co">#&gt; 3:    3.385     44.5  10.6   2.3  12.5  14.0    60     1     1      1     TRUE</span></span>
<span><span class="co">#&gt;    Dream_imp Sleep_imp Span_imp Gest_imp</span></span>
<span><span class="co">#&gt;       &lt;lgcl&gt;    &lt;lgcl&gt;   &lt;lgcl&gt;   &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt; 1:      TRUE     FALSE    FALSE    FALSE</span></span>
<span><span class="co">#&gt; 2:     FALSE     FALSE    FALSE    FALSE</span></span>
<span><span class="co">#&gt; 3:      TRUE     FALSE    FALSE    FALSE</span></span></code></pre></div>
<p>Results and information about missing/imputed values can be shown in
the plot margins:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dream"</span>, <span class="st">"Sleep"</span>, <span class="st">"Dream_imp"</span>, <span class="st">"Sleep_imp"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/marginplot.html">marginplot</a></span><span class="op">(</span><span class="va">dataDS</span>, delimiter <span class="op">=</span> <span class="st">"_imp"</span>, main <span class="op">=</span> <span class="st">"Imputation with Default Model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vimpute_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The default output are the imputed dataset and the prediction
history.</p>
<p>In this plot three differnt colors are used in the top-right. These
colors represent the structure of missings.</p>
<ul>
<li>
<strong><font color="#8b5a00">brown</font></strong> points represent
values where <code>Dream</code> was missing initially</li>
<li>
<strong><font color="#ffa500">beige</font></strong> points represent
values where <code>Sleep</code> was missing initially</li>
<li>
<strong>black</strong> points represent values where both
<code>Dream</code> and <code>Sleep</code> were missing initially</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="advanced-options">Advanced Options<a class="anchor" aria-label="anchor" href="#advanced-options"></a>
</h2>
<div class="section level4">
<h4 id="parameter-method">Parameter <code>method</code><a class="anchor" aria-label="anchor" href="#parameter-method"></a>
</h4>
<p><small><em>(default: “ranger” for all variables)</em></small></p>
<p>Specifies the machine learning method used for imputation of each
variable. In this example, different imputation methods are specified
for each variable. The <code>NonD</code> variable uses a robust method,
<code>Dream</code> and <code>Span</code> are using ranger,
<code>Sleep</code> uses xgboost, <code>Gest</code> uses a regularized
method and <code>class</code> uses a robust method.</p>
<ul>
<li>
<strong><code>"robust"</code></strong>: Robust regression models
<ul>
<li>
<code>lmrob</code> for numeric variables: Implements MM-estimation
for resistance to outliers</li>
<li>
<code>glmrob</code> for binary factors: Uses robust estimators to
reduce outlier influence</li>
</ul>
</li>
<li>
<strong><code>"regularized"</code></strong>: Regularized regression
(<code>glmnet</code>)
<ul>
<li>Uses elastic net regularization<br>
</li>
<li>Automatically handles multicollinearity<br>
</li>
</ul>
</li>
<li>
<strong><code>"ranger"</code></strong>: Random Forest
<ul>
<li>Fast implementation of random forests<br>
</li>
<li>Handles non-linear relationships well<br>
</li>
</ul>
</li>
<li>
<strong><code>"xgboost"</code></strong>: Gradient Boosted Trees
<ul>
<li>State-of-the-art tree boosting<br>
</li>
<li>Handles mixed data types well</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vimpute.html">vimpute</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>NonD <span class="op">=</span> <span class="st">"robust"</span>, Dream <span class="op">=</span> <span class="st">"ranger"</span>, Sleep <span class="op">=</span> <span class="st">"xgboost"</span>, Span <span class="op">=</span> <span class="st">"ranger"</span> , Gest <span class="op">=</span> <span class="st">"regularized"</span><span class="op">)</span>,</span>
<span>  pred_history <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataDS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result_mixed</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dream"</span>, <span class="st">"Sleep"</span>, <span class="st">"Dream_imp"</span>, <span class="st">"Sleep_imp"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/marginplot.html">marginplot</a></span><span class="op">(</span><span class="va">dataDS</span>, delimiter <span class="op">=</span> <span class="st">"_imp"</span>, main <span class="op">=</span> <span class="st">"Imputation with different Models for each Variable"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vimpute_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The side-by-side margin plots compare the performance of two
imputation methods: xgboost (left) and regularized (right):</p>
<p><img src="vimpute_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>xgboost handles missing values with data-driven, uneven imputations
that capture complex patterns but may be less stable, while regularized
methods produce smoother, more conservative estimates that are less
prone to overfitting. The key difference lies in flexibility (xgboost)
versus robustness (regularization).</p>
</div>
<div class="section level4">
<h4 id="parameter-pmm">Parameter <code>pmm</code><a class="anchor" aria-label="anchor" href="#parameter-pmm"></a>
</h4>
<p><small><em>(default: TRUE for all numeric variables)</em></small></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vimpute.html">vimpute</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>NonD <span class="op">=</span> <span class="st">"robust"</span>, </span>
<span>                Dream <span class="op">=</span> <span class="st">"ranger"</span>, </span>
<span>                Sleep <span class="op">=</span> <span class="st">"xgboost"</span>, </span>
<span>                Span <span class="op">=</span> <span class="st">"ranger"</span> , </span>
<span>                Gest <span class="op">=</span> <span class="st">"regularized"</span><span class="op">)</span>,</span>
<span>  pmm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>NonD <span class="op">=</span> <span class="cn">FALSE</span>, Dream <span class="op">=</span> <span class="cn">TRUE</span>, Sleep <span class="op">=</span> <span class="cn">FALSE</span>, Span <span class="op">=</span> <span class="cn">FALSE</span> , Gest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>If TRUE, imputed values are restricted to actual observed values in
the dataset, ensuring realism but potentially limiting variability. If
FALSE, raw model predictions are used, allowing greater flexibility but
risking implausible or extreme imputations.</p>
</div>
<div class="section level4">
<h4 id="parameter-formula">Parameter <code>formula</code><a class="anchor" aria-label="anchor" href="#parameter-formula"></a>
</h4>
<p><small><em>(default: FALSE)</em></small></p>
<p>Specifies custom model formulas for imputation of each variable,
offering precise control over the imputation models.</p>
<p><strong>Key Features:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Variable-Specific Models</strong>
<ul>
<li><p>Each formula specifies which predictors should be used for
imputing a particular variable</p></li>
<li><p>Enables different predictor sets for different target
variables</p></li>
<li>
<p>Example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">income</span> <span class="op">~</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span>,</span>
<span>  <span class="va">blood_pressure</span> <span class="op">~</span> <span class="va">weight</span> <span class="op">+</span> <span class="va">age</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</li>
<li>
<strong>Transformations Support</strong>
<ul>
<li>
<p>Handles common transformations on both sides of the formula:</p>
<ul>
<li>Response transformations: <code>log(y)</code>, <code>sqrt(y)</code>,
<code>exp(y)</code>, <code>I(1/y)</code>
</li>
<li>Predictor transformations: <code>log(x1)</code>,
<code>poly(x2, 2)</code>, etc.</li>
</ul>
</li>
<li>
<p>Example with transformations:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">education</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">blood_pressure</span><span class="op">)</span> <span class="op">~</span> <span class="va">weight</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</li>
<li>
<strong>Interaction Terms</strong>
<ul>
<li><p>Supports interaction terms using <code>:</code> or <code>*</code>
syntax (on the right side)</p></li>
<li>
<p>Example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">price</span> <span class="op">~</span> <span class="va">sqft</span> <span class="op">*</span> <span class="va">neighborhood</span> <span class="op">+</span> <span class="va">year_built</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</li>
</ol>
<p><strong>Example Demonstration:</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">vimpute</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">setNames</span>(<span class="fu">as.list</span>(<span class="fu">rep</span>(<span class="st">"regularized"</span>, <span class="fu">ncol</span>(data))), <span class="fu">names</span>(data))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">list</span>(</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    NonD <span class="sc">~</span> Dream <span class="sc">+</span> Sleep,              <span class="co"># Linear combination</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    Span <span class="sc">~</span> Dream<span class="sc">:</span>Sleep <span class="sc">+</span> Gest,         <span class="co"># With interaction term</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    <span class="fu">log</span>(Gest) <span class="sc">~</span> Sleep <span class="sc">+</span> <span class="fu">exp</span>(Span)      <span class="co"># With transformations</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  )</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Interpreting the Example:</strong></p>
<ol style="list-style-type: decimal">
<li>For <code>NonD</code>:
<ul>
<li>Uses linear combination of <code>Dream</code> and <code>Sleep</code>
variables</li>
<li>Model: <code>NonD = β₀ + β₁*Dream + β₂*Sleep + ε</code>
</li>
</ul>
</li>
<li>For <code>Span</code>:
<ul>
<li>Includes interaction between <code>Dream</code> and
<code>Sleep</code>
</li>
<li>Plus main effect of <code>Gest</code>
</li>
<li>Model: <code>Span = β₀ + β₁*Dream*Sleep + β₂*Gest + ε</code>
</li>
</ul>
</li>
<li>For <code>Gest</code>:
<ul>
<li>Uses log-transformed response</li>
<li>Predictors include <code>Sleep</code> and exponential of
<code>Span</code>
</li>
<li>Model:
<code>log(Gest) = β₀ + β₁*Sleep + β₂*exp(Span) + ε</code>
</li>
</ul>
</li>
<li>For <code>Sleep</code> and <code>Dream</code> all other variables
are used as predictors</li>
</ol>
<p><strong>Notes:</strong></p>
<ul>
<li>Only works with methods <code>"robust"</code> and
<code>"regularized"</code>
</li>
<li>All model.matrix-compatible functions work for predictors (for more
information see ?model.matrix)</li>
<li>Response transformations (left side) are automatically
back-transformed</li>
</ul>
</div>
<div class="section level4">
<h4 id="parameter-tune">Parameter <code>tune</code><a class="anchor" aria-label="anchor" href="#parameter-tune"></a>
</h4>
<p><small><em>(default: FALSE)</em></small></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vimpute.html">vimpute</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  tune <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Whether to perform hyperparameter tuning (only possible if seq =
TRUE):</p>
<ul>
<li>When TRUE:
<ul>
<li>Conducts randomized parameter search (after half of the
iterations)</li>
<li>Uses best performing configuration</li>
</ul>
</li>
<li>When FALSE:
<ul>
<li>Uses default model parameters</li>
<li>Recommended: TRUE for optimal performance</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="parameters-nseq-and-eps">Parameters <code>nseq</code> and <code>eps</code><a class="anchor" aria-label="anchor" href="#parameters-nseq-and-eps"></a>
</h4>
<p><small><em>(default: 10 and default: 0.005)</em></small></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vimpute.html">vimpute</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  nseq <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.01</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><code>nseq</code> describes the number of sequential imputation
iterations. Higher values:</p>
<ul>
<li>Allow more refinement</li>
<li>Increase computation time</li>
</ul>
<p><code>eps</code> describes the convergence threshold for sequential
imputation:</p>
<ul>
<li>Stops early if changes between iterations &lt; eps</li>
<li>Smaller values: Require more precise convergence but may need more
iterations</li>
</ul>
</div>
<div class="section level4">
<h4 id="parameter-imp_var">Parameter <code>imp_var</code><a class="anchor" aria-label="anchor" href="#parameter-imp_var"></a>
</h4>
<p><small><em>(default: TRUE)</em></small></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vimpute.html">vimpute</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  imp_var <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Creating indicator variables for imputed values adds “_imp” columns
(TRUE/FALSE) to mark which data points were imputed. This is
particularly useful for tracking imputation effects and conducting
diagnostic analyses.</p>
</div>
<div class="section level4">
<h4 id="parameter-pred_history">Parameter <code>pred_history</code><a class="anchor" aria-label="anchor" href="#parameter-pred_history"></a>
</h4>
<p><small><em>(default: TRUE)</em></small></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">pred_history</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    iteration variable index predicted_values</span></span>
<span><span class="co">#&gt;        &lt;int&gt;   &lt;char&gt; &lt;int&gt;            &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:        10    Sleep    62             10.7</span></span>
<span><span class="co">#&gt; 2:        10     Span     4              7.0</span></span>
<span><span class="co">#&gt; 3:        10     Span    13              6.0</span></span>
<span><span class="co">#&gt; 4:        10     Span    35              6.0</span></span>
<span><span class="co">#&gt; 5:        10     Span    36              7.0</span></span>
<span><span class="co">#&gt; 6:        10     Gest    13             42.0</span></span>
<span><span class="co">#&gt; 7:        10     Gest    19            225.0</span></span>
<span><span class="co">#&gt; 8:        10     Gest    20             90.0</span></span>
<span><span class="co">#&gt; 9:        10     Gest    56             33.0</span></span></code></pre></div>
<p>When enabled (TRUE), this option saves prediction trajectories in
<code>$pred_history</code>, allowing users to track how imputed values
evolve across iterations. This feature is particularly useful for
diagnosing convergence issues.</p>
</div>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>In order to validate the performance of vimpute() the iris dataset is
used. Firstly, some values are randomly set to <code>NA</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glin.github.io/reactable/" class="external-link">reactable</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">as.data.table</span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S.Length"</span>,<span class="st">"S.Width"</span>,<span class="st">"P.Length"</span>,<span class="st">"P.Width"</span>,<span class="st">"Species"</span><span class="op">)</span></span>
<span><span class="co"># randomly produce some missing values in the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">nbr_missing</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>row<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>,size <span class="op">=</span> <span class="va">nbr_missing</span>,replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,size <span class="op">=</span> <span class="va">nbr_missing</span>,replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="va">y</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span></span>
<span></span>
<span><span class="fu"><a href="../reference/aggr.html">aggr</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p><img src="vimpute_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; S.Length  S.Width P.Length  P.Width  Species </span></span>
<span><span class="co">#&gt;       12       10       13       12        0</span></span></code></pre></div>
<p>The data contains missing values across all variables, with some
observations missing multiple values. The subsequent step involves
variable imputation, and the following tables present the rounded first
five imputation results for each variable.</p>
<p>For default model:</p>
<div class="reactable html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"TRUE1":[5.1,5.1,7,5.6,5.4],"IMPUTED1":[5.3,5.2,6.4,5.6,6],"TRUE2":[3.8,4.1,3.4,3.5,2.8],"IMPUTED2":[3.5,3.5,3.5,3.4,2.8],"TRUE3":[1.1,1.9,4.1,3.9,4.7],"IMPUTED3":[1.4,1.5,3.7,4.1,4.6],"TRUE4":[0.3,0.2,0.2,0.2,0.3],"IMPUTED4":[0.2,0.4,0.3,0.2,0.3]},"columns":[{"id":"TRUE1","name":"True","type":"numeric"},{"id":"IMPUTED1","name":"Imputed","type":"numeric"},{"id":"TRUE2","name":"True","type":"numeric"},{"id":"IMPUTED2","name":"Imputed","type":"numeric"},{"id":"TRUE3","name":"True","type":"numeric"},{"id":"IMPUTED3","name":"Imputed","type":"numeric"},{"id":"TRUE4","name":"True","type":"numeric"},{"id":"IMPUTED4","name":"Imputed","type":"numeric"}],"columnGroups":[{"name":"S.Length","columns":["TRUE1","IMPUTED1"]},{"name":"S.Width","columns":["TRUE2","IMPUTED2"]},{"name":"P.Length","columns":["TRUE3","IMPUTED3"]},{"name":"P.Width","columns":["TRUE4","IMPUTED4"]}],"highlight":true,"bordered":true,"striped":true,"dataKey":"4b90bf913b4fe3e4d36b3a7b288d9e22"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p>For xgboost model:</p>
<div class="reactable html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"TRUE1":[5.1,5.1,7,5.6,5.4],"IMPUTED1":[5.4,5.2,6.4,6,6.1],"TRUE2":[3.8,4.1,3.4,3.5,2.8],"IMPUTED2":[3.6,3.6,3.6,2.7,2.7],"TRUE3":[1.1,1.9,4.1,3.9,4.7],"IMPUTED3":[1.4,1.5,3.7,4.3,4.7],"TRUE4":[0.3,0.2,0.2,0.2,0.3],"IMPUTED4":[0.2,0.4,0.3,0.2,0.2]},"columns":[{"id":"TRUE1","name":"True","type":"numeric"},{"id":"IMPUTED1","name":"Imputed","type":"numeric"},{"id":"TRUE2","name":"True","type":"numeric"},{"id":"IMPUTED2","name":"Imputed","type":"numeric"},{"id":"TRUE3","name":"True","type":"numeric"},{"id":"IMPUTED3","name":"Imputed","type":"numeric"},{"id":"TRUE4","name":"True","type":"numeric"},{"id":"IMPUTED4","name":"Imputed","type":"numeric"}],"columnGroups":[{"name":"S.Length","columns":["TRUE1","IMPUTED1"]},{"name":"S.Width","columns":["TRUE2","IMPUTED2"]},{"name":"P.Length","columns":["TRUE3","IMPUTED3"]},{"name":"P.Width","columns":["TRUE4","IMPUTED4"]}],"highlight":true,"bordered":true,"striped":true,"dataKey":"1d253bc2915d481e2ad67fa70dd5992e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matthias Templ, Alexander Kowarik, Andreas Alfons, Johannes Gussenbauer, Nina Niederhametner, Eileen Vattheuer, Gregor de Cillia, Wolfgang Rannetbauer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
